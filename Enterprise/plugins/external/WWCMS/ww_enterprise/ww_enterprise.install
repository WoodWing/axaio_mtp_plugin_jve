<?php

function ww_enterprise_install() {
	drupal_install_schema('ww_enterprise_story');
}

function ww_enterprise_uninstall() {
	drupal_uninstall_schema('ww_enterprise_story');
}

/**
 * Implementation of hook_enable
 *
 */
function ww_enterprise_enable()
{
	// Attach Images Attach Images
	variable_set('image_attach_ww_enterprise', '1');
	// Teaser image size Thumbnail
	variable_set('image_attach_size_teaser_ww_enterprise', 'thumbnail');
	// Full node image size Preview
	variable_set('image_attach_size_body_ww_enterprise', 'preview');
}

function ww_enterprise_story_schema(){
	$schema['ww_enterprise_story'] = array(
		'fields' => array(
			'vid' => array(
				'type' => 'int',
				'unsigned' => TRUE,
				'not null' => TRUE,
				'default' => 0
			),
			'nid' => array(
				'type' => 'int',
				'unsigned' => TRUE,
				'not null' => TRUE,
				'default' => 0
			),
			'writer' => array(
				'type' => 'varchar',
				'length' => 127,
				'not null' => TRUE,
				'default' => ''
			)
		),
		'indexes' => array('nid' => array('nid')),
		'primairy key' => array('vid')
	);

	return $schema;
}

/**
 * Implementaton of hook_requirements
 *
 * @param string $phase
 */
function ww_enterprise_requirements($phase)
{
	$requirements = array();

	// runtime requirements are only listed in the status report
	if ($phase == 'runtime'){
		// check settings (only if they're set not their value)
		$keywordsVoc = variable_get('ww_enterprise_keywords_vocabulary', '');
		$categoryVoc = variable_get('ww_enterprise_category_vocabulary', '');
		$categoryDef = variable_get('ww_enterprise_category_default', '');
		if ($keywordsVoc == '' || $categoryVoc == '' || $categoryDef == ''){
			$requirements['ww_enterprise_config'] = array(
				'title' => t('WoodWing Enterprise module'),
				'value' => t('Not configured'),
				'description' => t('WoodWing Enterprise module has not been configures yet'),
				'severity' => REQUIREMENT_WARNING);
		}
	}

	return $requirements;
}

?>
