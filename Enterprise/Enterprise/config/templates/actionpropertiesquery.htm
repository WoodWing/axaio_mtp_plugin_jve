<!--
     Do visit actionproperties.htm and actionpropertiesquery.htm when there are fixes done in the javascript areas.
-->
<script language="javascript">
function myconfirm(code)
{
	switch(code) {
        case 'deleteAllSelected':
            if( isThereAnyCheckboxesChecked() ) {
                txt = "Are you sure you want to delete the selected properties?"; // 10.x.x TODO: Localise the string
            } else {
                return alert( "There is no row selected for deletion." ); // 10.x.x TODO: Localise the string
            }
            break;
        case 'reset':
            txt = "Are you sure you want to reset? (This will delete all properties including the mandatory properties)."; // 10.x.x TODO: Localise the string
            break;
    }
	return confirm(txt);
}

function isThereAnyCheckboxesChecked()
{
    var countCheckBoxes = document.forms['propfilter'].recs.value;
    for(var i = 0; i < countCheckBoxes; i++) {
        var objCheckBox = document.forms['propfilter'].elements['multiDelete'+i];
        if( objCheckBox !== undefined && objCheckBox.checked ) {
			return true;
        }
    }
    return false;
}

function checkDeleteCheckboxes()
{
    var countCheckBoxes = document.forms['propfilter'].recs.value;
    for(var i = 0; i < countCheckBoxes; i++) {
        var objCheckBox = document.forms['propfilter'].elements['multiDelete'+i];
        if( objCheckBox !== undefined ) {
            if( objCheckBox.disabled == false ) {
                objCheckBox.checked = !(objCheckBox.checked)
            }
        }
    }
    return false;
}

function SetCombos(sAction)
{
    var f = document.forms.propfilter;
    f.action.value = sAction;
    f.submit();
}

$(document).ready(function() {
    // Drawing the dialog box.
    $(function dialogBox() {
        $("#dialog_confirm").dialog({
            autoOpen: false,
            resizable: false,
            height: "auto",
            width: 400,
            modal: true,
            zIndex: 1000,
            buttons: {
                "Yes": function() {
                    $("#addProperties").val( "add" );
                    $("#addDefaultDynamic").val( "true" );
                    $( this ).dialog( "close" );
                    $( "#propfilter" ).submit();
                },
                "No": function() {
                    $("#addProperties").val( "add" );
                    $("#addDefaultDynamic").val( "false" );
                    $( this ).dialog( "close" );
                    $( "#propfilter" ).submit();
                }
            },
        }).parent().appendTo($("#propfilter"));
    });

    // Event when dialog_button is clicked.
    $("#dialog_button").click( function( event ){
        event.preventDefault();
        if( $("input[name=recs]").val() == 0 ){
            $("#dialog_confirm").dialog( "open" );
        } else { // There're already records on the page
            $("#addProperties").val( "add" );
            $( "#propfilter" ).submit();
        }
    });

    $( "#updateButton" ).click( function() {
        $( '#updateProperties' ).val( "update" );
        $( "#propfilter" ).submit();
    });

    $( "#resetButton" ).click( function() {
        if( myconfirm( 'reset' ) ) {
            $( '#resetProperties' ).val( "reset" );
            $( "#propfilter" ).submit();
        }
    });

    $( "#deleteButton" ).click( function() {
        if( myconfirm( 'deleteAllSelected' ) ) {
            $( '#deleteProperties' ).val( "delete" );
            $( "#propfilter" ).submit();
        }
    });

    // Input box 'Order' during update
    $( "#order" ).keypress( function( event ) {
        if( event.key == "Enter" ) {
            $( '#updateProperties' ).val( "update" );
            $( "#propfilter" ).submit();
        }
    });

    // Event for tooltips.
    $( function() {
        $( document ).tooltip();
    } );

    // Starting point: The action combo box
    $( function() {
        $("select[name=action]").focus();
    });
});
</script>


<style>
	.tooltip-wrapper {
		display: inline-block; /* display: block works as well */
		margin: 1px; /* make some space so the tooltip is visible */
	}

	/* Only applicable for disabled elements */
	.tooltip-wrapper input[disabled] {
		/* don't let button block mouse events from reaching wrapper */
		pointer-events: none;
	}

	/* Overwrite the jquery-ui tooltip (popup) style to be similar to Enterprise */
	.ui-tooltip {
		background-color: #777;
		color: white;
		font-size: 8pt;
	}
</style>

<table class="appframe"><tr class="text"><td>
	
	<!-- app header -->
	<table class="apptitlebar">
		<tr>
			<td><img class="apptitleicon" src="../../config/images/dialogs.gif"/></td>
			<td>&nbsp;<span class="apptitletext"><!--RES:QRY_SETUP--></span></td>
		</tr>
	</table>
	
	<!-- app body -->
	<form id="propfilter" action="actionpropertiesquery.php" method="post">
	<table class="listframe" width="100%"><tr><td>
		<table class="listpane">
			<tr>
				<th width="100"><!--RES:ACT_ACTION--></th>
			</tr>
			<tr>
				<td valign="top"><!--COMBO:ACTION--></td>
			</tr>
		</table>
		<br/>
		<table class="listpane">
			<tr>
				<th><!--RES:PVW_CUSTOM--></th>
			</tr>
			<tr>
				<td valign="top"><!--PUB_TYPE_ACTION_LIST--></td>
			</tr>
		</table>
		<br/>
		<table class="listpane">
			<tr>
				<th style="<!--DELETE_COLUMN-->">
					<div class="tooltip-wrapper">
						<input type="checkbox" name="multiDeleteToggle" onClick="javascript:checkDeleteCheckboxes();">
					</div>
				</th>
				<th><!--RES:LIS_ORDER--></th>
				<th><!--RES:OBJ_PROPERTY--></th>
			</tr>
			<!--ROWS-->
		</table>
		<br/>
		<table class="listbtnbar">
			<tr>
				<td>
					<button style="<!--RESET_BUTTON-->" type="button" id="resetButton"><!--RES:BUT_RESET--></button>
					<input type="hidden" id="resetProperties" name="resetProperties" value="">

					<button style="<!--DELETE_BUTTON-->" type="button" id="deleteButton"><!--RES:ACT_DELETE_SELECTED--></button>
					<input type="hidden" id="deleteProperties" name="deleteProperties" value="">

					<button style="<!--UPDATE_BUTTON-->" type="button" id="updateButton"><!--RES:BUT_UPDATE--></button>
					<input type="hidden" id="updateProperties" name="updateProperties" value="">

					<button style="<!--ADD_BUTTON-->" type="button" id="dialog_button"><!--RES:ACT_ADD--></button>
					<input style="<!--ADD_BUTTON-->" type="hidden" id="addProperties" name="addProperties" value="">
					<input style="<!--ADD_BUTTON-->" type="hidden" id="addDefaultDynamic" name="addDefaultDynamic" value="false">
					<!--10.x.x TODO: Localise the string-->
					<div   style="display:none" id="dialog_confirm" title="Add default fields?">
						<p>
							<span style="float: left; margin: 0 0px 0px 0;"></span>
							This is a first setup for this configuration,
							mandatory properties (if there's any) will be added automatically. <br/>
							There are also some regularly used properties, do you want to add them? <br/>
							(Note that you will be able to remove these regularly used properties or reset
							the configuration later.)
						</p>
					</div>
				</td>
			</tr>
		</table>
	</td></tr></table>
	</form>

</td></tr></table>
